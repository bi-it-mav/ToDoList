@implements IDisposable
@inject StateChangeNotifier StateChangeNotifier

@code {
    private readonly List<IDisposable> _disposables = [];

    public async Task StateChangeSubscribeAsync(Type topic, Func<Task> updateState)
    {
        _disposables.Add(await StateChangeNotifier.SubscribeAsync(topic, async () => {
            await updateState();
            StateHasChanged();
        }));
    }

    public void Dispose()
    {
        _disposables.ForEach(d => d.Dispose());
    }
}
